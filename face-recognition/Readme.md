# Face Recognition Project

## Overview
This repository is part of the ML-CaPsule project, specifically focusing on face recognition using machine learning techniques.

## Features
- **Face Detection**: Identifies faces in images and video streams.
- **Face Recognition**: Matches detected faces with known faces.
- **Real-time Processing**: Capable of processing video feeds for real-time face recognition.
- **Facial-Attribute Analysis** : Labels the face with {race, gender, age and emotion} 

## Requirements
- Python >3.9
- deepface
- #there are some explicit dependencies
- requests>=2.27.1
- numpy>=1.14.0
- pandas>=0.23.4
- gdown>=3.10.1
- tqdm>=4.30.0
- Pillow>=5.2.0
- opencv-python>=4.5.5.64
- tensorflow>=1.9.0
- keras>=2.2.0
- Flask>=1.1.2
- mtcnn>=0.1.0
- retina-face>=0.0.1
- fire>=0.4.0
- gunicorn>=20.1.0

## Installation
1. Clone the repository:
    ```bash
    git clone https://github.com/Raghucharan16/ML-CaPsule.git
    cd ML-CaPsule/face-recognition
    ```
2. Install the required packages:
    ```bash
    pip install -r requirements.txt
    ```
    
Here is an updated version of the README file that includes details about running the notebook and the outputs generated by the cells, covering the `extract_faces`, `verify`, `find`, `analyze`, and `represent` methods.

---

## Usage

1. **Running the Notebook:**
    - Open the `deepface.ipynb` Jupyter Notebook.
    - Execute each cell sequentially to perform the required operations.

## Notebook Operations and Outputs

### Importing Dependencies
The notebook starts by importing the necessary dependencies:

```python
from deepface import DeepFace
detector_backends = ['opencv', 'retinaface', 'mtcnn', 'ssd', 'dlib', 'mediapipe', 'yolov8', 'centerface']
```
Output:
```
TensorFlow logs and warnings about using CPU optimizations.
```

### Extracting Faces
Using the `extract_faces` function to extract faces from an image (`img1.jpg`) using the default backend (`opencv`):

```python
faces = DeepFace.extract_faces("img1.jpg")
faces
```
Output:
```
A list of dictionaries containing the face array and facial area details.
```

### Extracting Faces with a Different Backend
Extracting faces from an image (`img1.jpg`) using a different backend (`retinaface`):

```python
retina_face = DeepFace.extract_faces("img1.jpg", detector_backend="retinaface")
retina_face
```
Output:
```
A list of dictionaries containing the face array and facial area details using the `retinaface` backend.
```

### Verifying Faces
Using the `verify` method to verify if two images belong to the same person:

```python
result = DeepFace.verify(img1_path = "img1.jpg", img2_path = "img2.jpg")
result
```
Output:
```
A dictionary with keys like 'verified', 'distance', and 'threshold'.
Example:
{
  'verified': True,
  'distance': 0.25,
  'threshold': 0.30,
  'model': 'VGG-Face',
  'detector_backend': 'opencv'
}
```

### Finding Faces
Using the `find` method to find the most similar faces in a database:

```python
df = DeepFace.find(img_path = "img1.jpg", db_path = "database")
df
```
Output:
```
A Pandas DataFrame containing paths to the most similar images and their similarity scores.
Example:
         identity  VGG-Face_cosine  VGG-Face_euclidean_l2
0  database/img2.jpg        0.256789                0.349123
1  database/img3.jpg        0.276451                0.371456
```

### Analyzing Faces
Using the `analyze` method to analyze attributes such as age, gender, emotion, and race:

```python
demography = DeepFace.analyze(img_path = "img1.jpg", actions = ['age', 'gender', 'emotion', 'race'])
demography
```
Output:
```
A dictionary containing analysis results.
Example:
{
  'age': 25,
  'gender': {'gender': 'Woman', 'confidence': 99.99},
  'emotion': {'emotion': 'happy', 'confidence': 98.76},
  'dominant_race': {'race': 'white', 'confidence': 87.54}
}
```

### Representing Faces
Using the `represent` method to get a vector representation of the face:

```python
embedding = DeepFace.represent(img_path = "img1.jpg")
embedding
```
Output:
```
A list of vectors representing the face.
Example:
[
  0.024, 0.035, 0.045, ..., 0.067
]
```


## Notes
- Ensure you have the necessary dependencies installed. You can install them using pip:
    ```sh
    pip install deepface
    ```

- Replace `"img1.jpg"` with the path to your image file and `"database"` with the path to your image database.

For more information on using DeepFace, refer to the [DeepFace GitHub repository](https://github.com/serengil/deepface).

---









## Contributing
Contributions are welcome! Please open an issue or submit a pull request.
